<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Google Maps API in Excel - GIS Driver License</title><meta name="description" content=" I was tasked with building a carbon calculator for a conference. Delegates would enter their origin and the modes of transport. The system would then calculate the carbon cost and add it to a list. At the end of the conference we were going&hellip;"><meta name="generator" content="Publii Open-Source CMS for Static Site"><link rel="canonical" href="https://ggodfrey.gihub.io/publii/google-maps-api-in-excel.html"><link rel="alternate" type="application/atom+xml" href="https://ggodfrey.gihub.io/publii/feed.xml"><link rel="alternate" type="application/json" href="https://ggodfrey.gihub.io/publii/feed.json"><meta property="og:title" content="Google Maps API in Excel"><meta property="og:site_name" content="GIS Driver License"><meta property="og:description" content=" I was tasked with building a carbon calculator for a conference. Delegates would enter their origin and the modes of transport. The system would then calculate the carbon cost and add it to a list. At the end of the conference we were going&hellip;"><meta property="og:url" content="https://ggodfrey.gihub.io/publii/google-maps-api-in-excel.html"><meta property="og:type" content="article"><style>:root{--body-font:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,Oxygen,Ubuntu,Cantarell,"Fira Sans","Droid Sans","Helvetica Neue",Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";--heading-font:var(--body-font);--logo-font:var(--body-font);--menu-font:var(--body-font)}</style><link rel="stylesheet" href="https://ggodfrey.gihub.io/publii/assets/css/style.css?v=3338deef7764b34eb54d4451f0abe482"><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://ggodfrey.gihub.io/publii/google-maps-api-in-excel.html"},"headline":"Google Maps API in Excel","datePublished":"2020-09-28T22:04","dateModified":"2021-01-19T16:32","description":" I was tasked with building a carbon calculator for a conference. Delegates would enter their origin and the modes of transport. The system would then calculate the carbon cost and add it to a list. At the end of the conference we were going&hellip;","author":{"@type":"Person","name":"George Godfrey"},"publisher":{"@type":"Organization","name":"George Godfrey"}}</script></head><body><div class="container js-container"><nav class="menu"><ul class="navbar__menu"><li><a href="https://ggodfrey.gihub.io/publii/" target="_self">Blog</a></li><li><a href="https://ggodfrey.gihub.io/publii/about-2.html" target="_self">About</a></li></ul></nav><div class="content"><header class="top"><div class="top__item"><a class="logo" href="https://ggodfrey.gihub.io/publii/">GIS Driver License</a></div><div class="top__item top__item--right"><button class="menu-toggle js-menu-toggle" aria-label="Menu" aria-expanded="false"><span class="menu-toggle-box"><span class="menu-toggle-inner">Menu</span></span></button></div></header><main class="main"><article class="post"><div class="main__left"><figure class="hero"><img src="https://ggodfrey.gihub.io/publii/media/website/London-2.PNG" srcset="https://ggodfrey.gihub.io/publii/media/website/responsive/London-2-xs.PNG 300w, https://ggodfrey.gihub.io/publii/media/website/responsive/London-2-sm.PNG 480w, https://ggodfrey.gihub.io/publii/media/website/responsive/London-2-md.PNG 768w, https://ggodfrey.gihub.io/publii/media/website/responsive/London-2-lg.PNG 1024w, https://ggodfrey.gihub.io/publii/media/website/responsive/London-2-xl.PNG 1280w, https://ggodfrey.gihub.io/publii/media/website/responsive/London-2-2xl.PNG 1600w" sizes="(min-width: 61.3125em) 50vw, 100vw" loading="eager" width="1606" height="676" alt=""></figure><header><h1>Google Maps API in Excel</h1><p><time datetime="2020-09-28T22:04">September 28, 2020 </time>by <a href="https://ggodfrey.gihub.io/publii/authors/george-godfrey/" rel="author" title="George Godfrey">George Godfrey</a></p></header></div><div class="main__right"><div class="post__entry"><p></p><p>I was tasked with building a carbon calculator for a conference. Delegates would enter their origin and the modes of transport. The system would then calculate the carbon cost and add it to a list. At the end of the conference we were going to sum up the carbon cost and offset it with tree planting. Covid put a stop to the conference which was a win in terms of carbon.</p><p></p><p></p><p>The easiest way I could think of creating this was in excel and luckily you can access the bing and google maps apis from within Excel to calculate the distances. Bing Maps ended up being used as you can use it for free without significant limits.</p><p></p><p></p><p><strong>Get an api key here</strong>: https://www.bingmapsportal.com/</p><p></p><p></p><p><strong>Generate Lat and Long for the origin and desitinations</strong>:</p><p></p><p></p><p>First enter the address details into empty cells. Then we use the api call <strong>https://dev.virtualearth.net/REST/v1/Locations?countryRegion=$1&amp;adminDistrict=$2&amp;locality=$3&amp;postalCode=$4&amp;addressLine=$5&amp;maxResults=1&amp;o=xml&amp;key=$k</strong> to return the Lat and Long values. Within the string we need to substitute $1, $2, $3, $4, $5 and $k for values. We do this with a substitute formula <strong>=SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(point.url,"$1",C$16),"$2",C$15),"$3",C$14),"$4",C$13),"$5",C$12),"$k",bingmaps.key)</strong>. Then to return a result pass that line via the web service function <strong>=WEBSERVICE(C18)</strong>. The result us a very long string starting <strong>&lt;?xml</strong>. To filter out the information we need use <strong>=@FILTERXML(C20,"//Latitude[1]")</strong> and <strong>=@FILTERXML(C20,"//Longitude[1]")</strong>. The final result is four cells with the lat and long for the origin and destination.</p><p></p><p></p><p><strong>Calculate the travel distance between the two co-ordinates</strong>:</p><p></p><p></p><p>Similar to above we take an api call https://dev.virtualearth.net/REST/v1/Routes/DistanceMatrix?origins=$1&amp;destinations=$2&amp;travelMode=$3&amp;o=xml&amp;key=$k substitute in origin and destination co-orfinates, travel mode and api key. Call it with web service and filter out the travel distance component.</p><p></p><p></p><p>More info here: https://chandoo.org/wp/distance-between-places-excel-maps-api/</p><p></p><p></p><figure class="wp-block-image size-large"><figure class="wp-image-185"><img loading="lazy" src="https://ggodfrey.gihub.io/publii/media/posts/26/carbon-footprint-calculator.png" sizes="(min-width: 61.3125em) 50vw, 100vw" srcset="https://ggodfrey.gihub.io/publii/media/posts/26/responsive/carbon-footprint-calculator-xs.png 300w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/carbon-footprint-calculator-sm.png 480w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/carbon-footprint-calculator-md.png 768w" alt=""></figure></figure><p></p><p></p><p>To clear the origin and destination address cells I assigned a macro to a button labelled clear.</p><p></p><p></p><div class="wp-block-coblocks-gallery-masonry alignwide"><div class="coblocks-gallery has-caption-style-dark has-gutter"><ul class="has-grid-lrg has-gutter-15 has-gutter-mobile-15"><li class="coblocks-gallery--item"><figure class="coblocks-gallery--figure"><figure class="wp-image-180"><img loading="lazy" src="https://ggodfrey.gihub.io/publii/media/posts/26/asign-macro-to-button-1.png" sizes="(min-width: 61.3125em) 50vw, 100vw" srcset="https://ggodfrey.gihub.io/publii/media/posts/26/responsive/asign-macro-to-button-1-xs.png 300w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/asign-macro-to-button-1-sm.png 480w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/asign-macro-to-button-1-md.png 768w" alt="" data-id="180" data-imglink="" data-link="https://gisdriverslicence.wordpress.com/asign-macro-to-button-1/"></figure></figure></li><li class="coblocks-gallery--item"><figure class="coblocks-gallery--figure"><figure class="wp-image-181"><img loading="lazy" src="https://ggodfrey.gihub.io/publii/media/posts/26/clear-cells-macro-1.png" sizes="(min-width: 61.3125em) 50vw, 100vw" srcset="https://ggodfrey.gihub.io/publii/media/posts/26/responsive/clear-cells-macro-1-xs.png 300w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/clear-cells-macro-1-sm.png 480w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/clear-cells-macro-1-md.png 768w" alt="" data-id="181" data-imglink="" data-link="https://gisdriverslicence.wordpress.com/clear-cells-macro-1/"></figure></figure></li></ul></div></div><p></p><p></p><p>To copy the delegate details and carbon calculations into a records tab I assigned another macro to a submit button.</p><p></p><p></p><div class="wp-block-coblocks-gallery-masonry alignwide"><div class="coblocks-gallery has-caption-style-dark has-gutter"><ul class="has-grid-lrg has-gutter-15 has-gutter-mobile-15"><li class="coblocks-gallery--item"><figure class="coblocks-gallery--figure"><figure class="wp-image-183"><img loading="lazy" src="https://ggodfrey.gihub.io/publii/media/posts/26/submit-details-to-list.png" sizes="(min-width: 61.3125em) 50vw, 100vw" srcset="https://ggodfrey.gihub.io/publii/media/posts/26/responsive/submit-details-to-list-xs.png 300w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/submit-details-to-list-sm.png 480w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/submit-details-to-list-md.png 768w" alt="" data-id="183" data-imglink=""></figure></figure></li><li class="coblocks-gallery--item"><figure class="coblocks-gallery--figure"><figure class="wp-image-184"><img loading="lazy" src="https://ggodfrey.gihub.io/publii/media/posts/26/copy-to-record-sheet-macro.png" sizes="(min-width: 61.3125em) 50vw, 100vw" srcset="https://ggodfrey.gihub.io/publii/media/posts/26/responsive/copy-to-record-sheet-macro-xs.png 300w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/copy-to-record-sheet-macro-sm.png 480w, https://ggodfrey.gihub.io/publii/media/posts/26/responsive/copy-to-record-sheet-macro-md.png 768w" alt="" data-id="184" data-imglink=""></figure></figure></li></ul></div></div><p></p><footer><div class="post__tag-share"><div class="post__share"></div></div><div class="post__bio"><h3><a href="https://ggodfrey.gihub.io/publii/authors/george-godfrey/" title="George Godfrey">George Godfrey</a></h3></div></footer></div></div></article></main><footer class="footer"><div class="footer__copyright">Powered by <a href="https://getpublii.com" target="_blank" rel="nofollow noopener">Publii</a></div></footer></div></div><script defer="defer" src="https://ggodfrey.gihub.io/publii/assets/js/scripts.min.js?v=babd20e2a0a25821e63a0529c9feaae0"></script><script>var images = document.querySelectorAll('img[loading]');
   
           for (var i = 0; i < images.length; i++) {
               if (images[i].complete) {
                   images[i].classList.add('is-loaded');
               } else {
                   images[i].addEventListener('load', function () {
                       this.classList.add('is-loaded');
                   }, false);
               }
           }</script></body></html>